{
  "query": "WITH QuarterlyTrends AS (SELECT CASE WHEN MonthNumber BETWEEN 1 AND 3 THEN 'Q1' WHEN MonthNumber BETWEEN 4 AND 6 THEN 'Q2' WHEN MonthNumber BETWEEN 7 AND 9 THEN 'Q3' ELSE 'Q4' END as Quarter, Year, Country, Segment, SUM(CAST(GrossSales as DECIMAL(18,2))) as QuarterRevenue, SUM(CAST(Profit as DECIMAL(18,2))) as QuarterProfit, COUNT(*) as Transactions FROM [Upload_edaa4303640341b48950bb3eb0385f60_20251215203858] GROUP BY CASE WHEN MonthNumber BETWEEN 1 AND 3 THEN 'Q1' WHEN MonthNumber BETWEEN 4 AND 6 THEN 'Q2' WHEN MonthNumber BETWEEN 7 AND 9 THEN 'Q3' ELSE 'Q4' END, Year, Country, Segment), QuarterlyGrowth AS (SELECT Quarter, Year, Country, Segment, QuarterRevenue, QuarterProfit, Transactions, LAG(QuarterRevenue) OVER (PARTITION BY Country, Segment ORDER BY Year, Quarter) as PrevQuarterRevenue FROM QuarterlyTrends) SELECT Quarter, Year, Country, Segment, CAST(QuarterRevenue as DECIMAL(18,2)) as Revenue, CAST(QuarterProfit as DECIMAL(18,2)) as Profit, Transactions, CAST(CASE WHEN PrevQuarterRevenue IS NOT NULL AND PrevQuarterRevenue > 0 THEN ((QuarterRevenue - PrevQuarterRevenue) / PrevQuarterRevenue * 100) ELSE 0 END as DECIMAL(10,2)) as GrowthPercent FROM QuarterlyGrowth WHERE QuarterRevenue > 500000 ORDER BY Year, Quarter, GrowthPercent DESC"
}
