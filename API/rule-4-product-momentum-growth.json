{
  "query": "WITH ProductTrends AS (SELECT Product_1 as Product, Year, MonthName, MonthNumber, SUM(CAST(UnitsSold as DECIMAL(18,2))) as UnitsThisMonth, LAG(SUM(CAST(UnitsSold as DECIMAL(18,2)))) OVER (PARTITION BY Product_1 ORDER BY Year, MonthNumber) as UnitsPrevMonth FROM [Upload_edaa4303640341b48950bb3eb0385f60_20251215203858] GROUP BY Product_1, Year, MonthName, MonthNumber) SELECT Product, Year, MonthName, CAST(UnitsThisMonth as DECIMAL(18,2)) as CurrentMonthUnits, CAST(UnitsPrevMonth as DECIMAL(18,2)) as PreviousMonthUnits, CAST(CASE WHEN UnitsPrevMonth > 0 THEN ((UnitsThisMonth - UnitsPrevMonth) / UnitsPrevMonth * 100) ELSE 0 END as DECIMAL(10,2)) as GrowthPercent FROM ProductTrends WHERE UnitsPrevMonth IS NOT NULL AND UnitsThisMonth > 5000 ORDER BY GrowthPercent DESC"
}
